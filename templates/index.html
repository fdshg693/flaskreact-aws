<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>TODO アプリ</title>
  <style>
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji"; margin: 2rem; color: #1f2937; }
    h1 { margin-bottom: 1rem; }
    form.add { display: flex; gap: .5rem; margin-bottom: 1rem; }
    input[type="text"] { flex: 1; padding: .5rem .75rem; border: 1px solid #d1d5db; border-radius: .375rem; }
    button { padding: .5rem .75rem; border: 1px solid #d1d5db; background: #111827; color: white; border-radius: .375rem; cursor: pointer; }
    button.secondary { background: white; color: #111827; }
    ul { list-style: none; padding: 0; margin: 0; }
    li { display: flex; align-items: center; justify-content: space-between; padding: .5rem .75rem; border: 1px solid #e5e7eb; border-radius: .375rem; margin-bottom: .5rem; }
    .title { display: flex; align-items: center; gap: .5rem; }
    .done { text-decoration: line-through; color: #6b7280; }
    .actions { display: flex; gap: .5rem; }
  </style>
</head>
<body>
  <h1>TODO アプリ（Flask + SQLite）</h1>

  <form class="add" method="post" action="{{ url_for('add_task') }}">
    <input type="text" name="title" placeholder="やることを入力" required />
    <button type="submit">追加</button>
  </form>

  {% if tasks and tasks|length > 0 %}
    <ul>
    {% for t in tasks %}
      <li>
        <div class="title">
          <form method="post" action="{{ url_for('toggle_task', task_id=t['id']) }}">
            <button class="secondary" type="submit">{{ '✔' if t['completed'] else '○' }}</button>
          </form>
          <span class="{{ 'done' if t['completed'] else '' }}">{{ t['title'] }}</span>
        </div>
        <div class="actions">
          <form method="post" action="{{ url_for('delete_task', task_id=t['id']) }}" onsubmit="return confirm('削除しますか？');">
            <button type="submit">削除</button>
          </form>
        </div>
      </li>
    {% endfor %}
    </ul>
  {% else %}
    <p>まだタスクがありません。上で追加してみましょう。</p>
  {% endif %}
</body>
</html>
